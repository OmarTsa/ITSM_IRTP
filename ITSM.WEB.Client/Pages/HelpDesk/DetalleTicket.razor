@page "/helpdesk/ticket/{IdTicket:int}"
@using ITSM.Entidades
@using ITSM.WEB.Client.Servicios
@using MudBlazor
@inject TicketServicio _ticketServicio
@inject ISnackbar Snackbar

@rendermode InteractiveWebAssembly

@if (ticket == null)
{
    <MudProgressLinear Color="Color.Primary" Indeterminate="true" />
}
else
{
    <MudGrid>
        <MudItem xs="12" md="8">
            <MudPaper Class="pa-6" Elevation="3">
                <MudText Typo="Typo.h5" Class="mb-2">@ticket.Titulo</MudText>
                <MudDivider Class="mb-4" />
                <MudText Typo="Typo.body1" Style="white-space: pre-wrap;">@ticket.Descripcion</MudText>
            </MudPaper>
        </MudItem>

        <MudItem xs="12" md="4">
            <MudPaper Class="pa-6" Elevation="3">
                <MudText Typo="Typo.h6">Información del Ticket</MudText>
                <MudList T="string">
                    <MudListItem Text="@($"Estado: {ticket.Estado?.Nombre}")" Icon="@Icons.Material.Filled.Info" />
                    <MudListItem Text="@($"Prioridad: {ticket.Prioridad?.Nombre}")" Icon="@Icons.Material.Filled.PriorityHigh" />
                    <MudListItem Text="@($"Categoría: {ticket.Categoria?.Nombre}")" Icon="@Icons.Material.Filled.Category" />
                    <MudListItem Text="@($"Solicitante: {ticket.Solicitante?.NombreCompleto}")" Icon="@Icons.Material.Filled.Person" />
                    @if (ticket.Activo != null)
                    {
                        <MudListItem Text="@($"Equipo: {ticket.Activo.Marca} {ticket.Activo.Modelo}")" Icon="@Icons.Material.Filled.Computer" />
                        <MudListItem Text="@($"Patrimonial: {ticket.Activo.CodigoPatrimonial}")" Icon="@Icons.Material.Filled.QrCode" />
                    }
                </MudList>
            </MudPaper>
        </MudItem>
    </MudGrid>
}

@code {
    [Parameter] public int IdTicket { get; set; }
    private Ticket? ticket;

    protected override async Task OnInitializedAsync()
    {
        ticket = await _ticketServicio.ObtenerTicketPorId(IdTicket);
    }
}